<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>libnice Reference Manual: Bind</title>
<meta name="generator" content="DocBook XSL Stylesheets V1.78.1">
<link rel="home" href="index.html" title="libnice Reference Manual">
<link rel="up" href="ch04.html" title="STUN usages">
<link rel="prev" href="ch04.html" title="STUN usages">
<link rel="next" href="libnice-ICE.html" title="ICE">
<meta name="generator" content="GTK-Doc V1.21 (XML mode)">
<link rel="stylesheet" href="style.css" type="text/css">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table class="navigation" id="top" width="100%" summary="Navigation header" cellpadding="2" cellspacing="5"><tr valign="middle">
<td width="100%" align="left" class="shortcuts">
<a href="#" class="shortcut">Top</a><span id="nav_description">  <span class="dim">|</span> 
                  <a href="#libnice-Bind.description" class="shortcut">Description</a></span>
</td>
<td><a accesskey="h" href="index.html"><img src="home.png" width="16" height="16" border="0" alt="Home"></a></td>
<td><a accesskey="u" href="ch04.html"><img src="up.png" width="16" height="16" border="0" alt="Up"></a></td>
<td><a accesskey="p" href="ch04.html"><img src="left.png" width="16" height="16" border="0" alt="Prev"></a></td>
<td><a accesskey="n" href="libnice-ICE.html"><img src="right.png" width="16" height="16" border="0" alt="Next"></a></td>
</tr></table>
<div class="refentry">
<a name="libnice-Bind"></a><div class="titlepage"></div>
<div class="refnamediv"><table width="100%"><tr>
<td valign="top">
<h2><span class="refentrytitle"><a name="libnice-Bind.top_of_page"></a>Bind</span></h2>
<p>Bind — STUN Binding Usage</p>
</td>
<td class="gallery_image" valign="top" align="right"></td>
</tr></table></div>
<div class="refsect1">
<a name="libnice-Bind.stability-level"></a><h2>Stability Level</h2>
<acronym title="The intention of a Stable interface is to enable arbitrary third parties to
develop applications to these interfaces, release them, and have confidence that
they will run on all minor releases of the product (after the one in which the
interface was introduced, and within the same major release). Even at a major
release, incompatible changes are expected to be rare, and to have strong
justifications.
"><span class="acronym">Stable</span></acronym>, unless otherwise indicated
</div>
<div class="refsect1">
<a name="libnice-Bind.functions"></a><h2>Functions</h2>
<div class="informaltable"><table width="100%" border="0">
<colgroup>
<col width="150px" class="functions_return">
<col class="functions_name">
</colgroup>
<tbody>
<tr>
<td class="function_type">
<span class="returnvalue">size_t</span>
</td>
<td class="function_name">
<a class="link" href="libnice-Bind.html#stun-usage-bind-create" title="stun_usage_bind_create ()">stun_usage_bind_create</a> <span class="c_punctuation">()</span>
</td>
</tr>
<tr>
<td class="function_type">
<a class="link" href="libnice-Bind.html#StunUsageBindReturn" title="enum StunUsageBindReturn"><span class="returnvalue">StunUsageBindReturn</span></a>
</td>
<td class="function_name">
<a class="link" href="libnice-Bind.html#stun-usage-bind-process" title="stun_usage_bind_process ()">stun_usage_bind_process</a> <span class="c_punctuation">()</span>
</td>
</tr>
<tr>
<td class="function_type">
<span class="returnvalue">size_t</span>
</td>
<td class="function_name">
<a class="link" href="libnice-Bind.html#stun-usage-bind-keepalive" title="stun_usage_bind_keepalive ()">stun_usage_bind_keepalive</a> <span class="c_punctuation">()</span>
</td>
</tr>
<tr>
<td class="function_type">
<a class="link" href="libnice-Bind.html#StunUsageBindReturn" title="enum StunUsageBindReturn"><span class="returnvalue">StunUsageBindReturn</span></a>
</td>
<td class="function_name">
<a class="link" href="libnice-Bind.html#stun-usage-bind-run" title="stun_usage_bind_run ()">stun_usage_bind_run</a> <span class="c_punctuation">()</span>
</td>
</tr>
</tbody>
</table></div>
</div>
<div class="refsect1">
<a name="libnice-Bind.other"></a><h2>Types and Values</h2>
<div class="informaltable"><table width="100%" border="0">
<colgroup>
<col width="150px" class="name">
<col class="description">
</colgroup>
<tbody><tr>
<td class="datatype_keyword">enum</td>
<td class="function_name"><a class="link" href="libnice-Bind.html#StunUsageBindReturn" title="enum StunUsageBindReturn">StunUsageBindReturn</a></td>
</tr></tbody>
</table></div>
</div>
<div class="refsect1">
<a name="libnice-Bind.includes"></a><h2>Includes</h2>
<pre class="synopsis">#include &lt;stun/usages/bind.h&gt;
</pre>
</div>
<div class="refsect1">
<a name="libnice-Bind.description"></a><h2>Description</h2>
<p>The STUN Binding usage allows for easily creating and parsing STUN Binding
requests and responses. It offers both an asynchronous and a synchronous API
that uses the STUN timer usage.</p>
</div>
<div class="refsect1">
<a name="libnice-Bind.functions_details"></a><h2>Functions</h2>
<div class="refsect2">
<a name="stun-usage-bind-create"></a><h3>stun_usage_bind_create ()</h3>
<pre class="programlisting"><span class="returnvalue">size_t</span>
stun_usage_bind_create (<em class="parameter"><code><a class="link" href="libnice-StunAgent.html#StunAgent" title="StunAgent"><span class="type">StunAgent</span></a> *agent</code></em>,
                        <em class="parameter"><code><a class="link" href="libnice-StunMessage.html#StunMessage" title="struct StunMessage"><span class="type">StunMessage</span></a> *msg</code></em>,
                        <em class="parameter"><code><span class="type">uint8_t</span> *buffer</code></em>,
                        <em class="parameter"><code><span class="type">size_t</span> buffer_len</code></em>);</pre>
<p>Create a new STUN binding request to use with a STUN server.</p>
<div class="refsect3">
<a name="id-1.3.3.2.8.2.5"></a><h4>Parameters</h4>
<div class="informaltable"><table width="100%" border="0">
<colgroup>
<col width="150px" class="parameters_name">
<col class="parameters_description">
<col width="200px" class="parameters_annotations">
</colgroup>
<tbody>
<tr>
<td class="parameter_name"><p>agent</p></td>
<td class="parameter_description"><p>The <a class="link" href="libnice-StunAgent.html#StunAgent" title="StunAgent"><span class="type">StunAgent</span></a> to use to create the binding request</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>msg</p></td>
<td class="parameter_description"><p>The <a class="link" href="libnice-StunMessage.html#StunMessage" title="struct StunMessage"><span class="type">StunMessage</span></a> to build</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>buffer</p></td>
<td class="parameter_description"><p>The buffer to use for creating the <a class="link" href="libnice-StunMessage.html#StunMessage" title="struct StunMessage"><span class="type">StunMessage</span></a></p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>buffer_len</p></td>
<td class="parameter_description"><p>The size of the <em class="parameter"><code>buffer</code></em>
</p></td>
<td class="parameter_annotations"> </td>
</tr>
</tbody>
</table></div>
</div>
<div class="refsect3">
<a name="id-1.3.3.2.8.2.6"></a><h4>Returns</h4>
<p> The length of the built message.</p>
<p></p>
</div>
</div>
<hr>
<div class="refsect2">
<a name="stun-usage-bind-process"></a><h3>stun_usage_bind_process ()</h3>
<pre class="programlisting"><a class="link" href="libnice-Bind.html#StunUsageBindReturn" title="enum StunUsageBindReturn"><span class="returnvalue">StunUsageBindReturn</span></a>
stun_usage_bind_process (<em class="parameter"><code><a class="link" href="libnice-StunMessage.html#StunMessage" title="struct StunMessage"><span class="type">StunMessage</span></a> *msg</code></em>,
                         <em class="parameter"><code><span class="type">struct sockaddr</span> *addr</code></em>,
                         <em class="parameter"><code><span class="type">socklen_t</span> *addrlen</code></em>,
                         <em class="parameter"><code><span class="type">struct sockaddr</span> *alternate_server</code></em>,
                         <em class="parameter"><code><span class="type">socklen_t</span> *alternate_server_len</code></em>);</pre>
<p>Process a STUN binding response and extracts the mapped address from the STUN
message. Also checks for the ALTERNATE-SERVER attribute.</p>
<div class="refsect3">
<a name="id-1.3.3.2.8.3.5"></a><h4>Parameters</h4>
<div class="informaltable"><table width="100%" border="0">
<colgroup>
<col width="150px" class="parameters_name">
<col class="parameters_description">
<col width="200px" class="parameters_annotations">
</colgroup>
<tbody>
<tr>
<td class="parameter_name"><p>msg</p></td>
<td class="parameter_description"><p>The <a class="link" href="libnice-StunMessage.html#StunMessage" title="struct StunMessage"><span class="type">StunMessage</span></a> to process</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>addr</p></td>
<td class="parameter_description"><p>A pointer to a <span class="type">sockaddr</span> structure to fill with the mapped address
that the STUN server gives us</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>addrlen</p></td>
<td class="parameter_description"><p>The length of <em class="parameter"><code>add</code></em>
. rMust be set to the size of the <em class="parameter"><code>addr</code></em>
socket
address and will be set to the actual length of the socket address.</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>alternate_server</p></td>
<td class="parameter_description"><p>A pointer to a <span class="type">sockaddr</span> structure to fill with the
address of an alternate server to which we should send our new STUN
binding request, in case the currently used STUN server is requesting the use
of an alternate server. This argument will only be filled if the return value
of the function is <a class="link" href="libnice-Bind.html#STUN-USAGE-BIND-RETURN-ALTERNATE-SERVER:CAPS"><span class="type">STUN_USAGE_BIND_RETURN_ALTERNATE_SERVER</span></a></p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>alternate_server_len</p></td>
<td class="parameter_description"><p>The length of <em class="parameter"><code>alternate_server</code></em>
. Must be set to
the size of the <em class="parameter"><code>alternate_server</code></em>
socket address and will be set to the
actual length of the socket address.</p></td>
<td class="parameter_annotations"> </td>
</tr>
</tbody>
</table></div>
</div>
<div class="refsect3">
<a name="id-1.3.3.2.8.3.6"></a><h4>Returns</h4>
<p> A <a class="link" href="libnice-Bind.html#StunUsageBindReturn" title="enum StunUsageBindReturn"><span class="type">StunUsageBindReturn</span></a> value.
Note that <a class="link" href="libnice-Bind.html#STUN-USAGE-BIND-RETURN-TIMEOUT:CAPS"><span class="type">STUN_USAGE_BIND_RETURN_TIMEOUT</span></a> cannot be returned by this function</p>
<p></p>
</div>
</div>
<hr>
<div class="refsect2">
<a name="stun-usage-bind-keepalive"></a><h3>stun_usage_bind_keepalive ()</h3>
<pre class="programlisting"><span class="returnvalue">size_t</span>
stun_usage_bind_keepalive (<em class="parameter"><code><a class="link" href="libnice-StunAgent.html#StunAgent" title="StunAgent"><span class="type">StunAgent</span></a> *agent</code></em>,
                           <em class="parameter"><code><a class="link" href="libnice-StunMessage.html#StunMessage" title="struct StunMessage"><span class="type">StunMessage</span></a> *msg</code></em>,
                           <em class="parameter"><code><span class="type">uint8_t</span> *buf</code></em>,
                           <em class="parameter"><code><span class="type">size_t</span> len</code></em>);</pre>
<p>Creates a STUN binding indication that can be used for a keepalive.
Since this is an indication message, no STUN response will be generated
and it can only be used as a keepalive message.</p>
<div class="refsect3">
<a name="id-1.3.3.2.8.4.5"></a><h4>Parameters</h4>
<div class="informaltable"><table width="100%" border="0">
<colgroup>
<col width="150px" class="parameters_name">
<col class="parameters_description">
<col width="200px" class="parameters_annotations">
</colgroup>
<tbody>
<tr>
<td class="parameter_name"><p>agent</p></td>
<td class="parameter_description"><p>The <a class="link" href="libnice-StunAgent.html#StunAgent" title="StunAgent"><span class="type">StunAgent</span></a> to use to build the message</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>msg</p></td>
<td class="parameter_description"><p>The <a class="link" href="libnice-StunMessage.html#StunMessage" title="struct StunMessage"><span class="type">StunMessage</span></a> to build</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>buf</p></td>
<td class="parameter_description"><p>The buffer to use for creating the <a class="link" href="libnice-StunMessage.html#StunMessage" title="struct StunMessage"><span class="type">StunMessage</span></a></p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>len</p></td>
<td class="parameter_description"><p>The size of the <em class="parameter"><code>buf</code></em>
</p></td>
<td class="parameter_annotations"> </td>
</tr>
</tbody>
</table></div>
</div>
<div class="refsect3">
<a name="id-1.3.3.2.8.4.6"></a><h4>Returns</h4>
<p> The length of the message to send</p>
<p></p>
</div>
</div>
<hr>
<div class="refsect2">
<a name="stun-usage-bind-run"></a><h3>stun_usage_bind_run ()</h3>
<pre class="programlisting"><a class="link" href="libnice-Bind.html#StunUsageBindReturn" title="enum StunUsageBindReturn"><span class="returnvalue">StunUsageBindReturn</span></a>
stun_usage_bind_run (<em class="parameter"><code>const <span class="type">struct sockaddr</span> *srv</code></em>,
                     <em class="parameter"><code><span class="type">socklen_t</span> srvlen</code></em>,
                     <em class="parameter"><code><span class="type">struct sockaddr_storage</span> *addr</code></em>,
                     <em class="parameter"><code><span class="type">socklen_t</span> *addrlen</code></em>);</pre>
<p>This is a convenience function that will do a synchronous Binding request to
a server and wait for its answer. It will create the socket transports and
use the <a class="link" href="libnice-Timer.html#StunTimer" title="StunTimer"><span class="type">StunTimer</span></a> usage to send the request and handle the response.</p>
<div class="refsect3">
<a name="id-1.3.3.2.8.5.5"></a><h4>Parameters</h4>
<div class="informaltable"><table width="100%" border="0">
<colgroup>
<col width="150px" class="parameters_name">
<col class="parameters_description">
<col width="200px" class="parameters_annotations">
</colgroup>
<tbody>
<tr>
<td class="parameter_name"><p>srv</p></td>
<td class="parameter_description"><p>A pointer to the <span class="type">sockaddr</span> structure representing the STUN server's
address</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>srvlen</p></td>
<td class="parameter_description"><p>The length of <em class="parameter"><code>srv</code></em>
</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>addr</p></td>
<td class="parameter_description"><p>A pointer to a <span class="type">sockaddr</span> structure to fill with the mapped address
that the STUN server gives us</p></td>
<td class="parameter_annotations"> </td>
</tr>
<tr>
<td class="parameter_name"><p>addrlen</p></td>
<td class="parameter_description"><p>The length of <em class="parameter"><code>addr</code></em>
</p></td>
<td class="parameter_annotations"> </td>
</tr>
</tbody>
</table></div>
</div>
<div class="refsect3">
<a name="id-1.3.3.2.8.5.6"></a><h4>Returns</h4>
<p> A <a class="link" href="libnice-Bind.html#StunUsageBindReturn" title="enum StunUsageBindReturn"><span class="type">StunUsageBindReturn</span></a>.
Possible return values are <a class="link" href="libnice-Bind.html#STUN-USAGE-BIND-RETURN-SUCCESS:CAPS"><span class="type">STUN_USAGE_BIND_RETURN_SUCCESS</span></a>,
<a class="link" href="libnice-Bind.html#STUN-USAGE-BIND-RETURN-ERROR:CAPS"><span class="type">STUN_USAGE_BIND_RETURN_ERROR</span></a> and <a class="link" href="libnice-Bind.html#STUN-USAGE-BIND-RETURN-TIMEOUT:CAPS"><span class="type">STUN_USAGE_BIND_RETURN_TIMEOUT</span></a></p>
<p></p>
</div>
</div>
</div>
<div class="refsect1">
<a name="libnice-Bind.other_details"></a><h2>Types and Values</h2>
<div class="refsect2">
<a name="StunUsageBindReturn"></a><h3>enum StunUsageBindReturn</h3>
<p>Return value of <a class="link" href="libnice-Bind.html#stun-usage-bind-process" title="stun_usage_bind_process ()"><code class="function">stun_usage_bind_process()</code></a> and <a class="link" href="libnice-Bind.html#stun-usage-bind-run" title="stun_usage_bind_run ()"><code class="function">stun_usage_bind_run()</code></a> which
allows you to see what status the function call returned.</p>
<div class="refsect3">
<a name="id-1.3.3.2.9.2.4"></a><h4>Members</h4>
<div class="informaltable"><table width="100%" border="0">
<colgroup>
<col width="300px" class="enum_members_name">
<col class="enum_members_description">
<col width="200px" class="enum_members_annotations">
</colgroup>
<tbody>
<tr>
<td class="enum_member_name"><p><a name="STUN-USAGE-BIND-RETURN-SUCCESS:CAPS"></a>STUN_USAGE_BIND_RETURN_SUCCESS</p></td>
<td class="enum_member_description">
<p>The binding usage succeeded</p>
</td>
<td class="enum_member_annotations"> </td>
</tr>
<tr>
<td class="enum_member_name"><p><a name="STUN-USAGE-BIND-RETURN-ERROR:CAPS"></a>STUN_USAGE_BIND_RETURN_ERROR</p></td>
<td class="enum_member_description">
<p>There was an unknown error in the bind usage</p>
</td>
<td class="enum_member_annotations"> </td>
</tr>
<tr>
<td class="enum_member_name"><p><a name="STUN-USAGE-BIND-RETURN-INVALID:CAPS"></a>STUN_USAGE_BIND_RETURN_INVALID</p></td>
<td class="enum_member_description">
<p>The message is invalid and should be ignored</p>
</td>
<td class="enum_member_annotations"> </td>
</tr>
<tr>
<td class="enum_member_name"><p><a name="STUN-USAGE-BIND-RETURN-ALTERNATE-SERVER:CAPS"></a>STUN_USAGE_BIND_RETURN_ALTERNATE_SERVER</p></td>
<td class="enum_member_description">
<p>The binding request has an
ALTERNATE-SERVER attribute</p>
</td>
<td class="enum_member_annotations"> </td>
</tr>
<tr>
<td class="enum_member_name"><p><a name="STUN-USAGE-BIND-RETURN-TIMEOUT:CAPS"></a>STUN_USAGE_BIND_RETURN_TIMEOUT</p></td>
<td class="enum_member_description">
<p>The binding was unsuccessful because it has
timed out.</p>
</td>
<td class="enum_member_annotations"> </td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
</div>
<div class="footer">
<hr>
          Generated by GTK-Doc V1.21</div>
</body>
</html>